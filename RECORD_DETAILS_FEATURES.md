# 记录详情页面功能说明

## 概述
记录详情页面 (`/financial-list/[key]`) 提供了查看单个财务记录详细信息和关联收据的完整功能。

## 主要功能

### 1. 记录信息显示
- **基本信息**: 金额、日期、账户、姓名、描述、备注
- **状态管理**: 显示记录状态（Pending/Approved）
- **创建信息**: 创建者、创建日期
- **审批信息**: 审批者、审批日期（如果已审批）

### 2. 收据管理
- **收据列表**: 显示所有关联的收据
- **收据预览**: 支持图片预览和文件下载
- **收据操作**: 查看、下载、删除收据
- **收据信息**: 文件名、上传日期、上传者、描述

### 3. 权限控制
- **查看权限**: 所有登录用户都可以查看记录详情
- **编辑权限**: 管理员和超级管理员可以编辑记录
- **删除权限**: 超级管理员可以删除记录
- **状态管理**: 管理员和超级管理员可以更改记录状态

### 4. 操作功能
- **返回列表**: 返回财务记录列表页面
- **编辑记录**: 跳转到编辑记录页面
- **删除记录**: 删除当前记录（需要确认）
- **状态切换**: 在Pending和Approved之间切换

## 页面布局

### 桌面端
- 响应式设计，适配不同屏幕尺寸
- 记录信息和收据信息分开展示
- 操作按钮位于页面顶部

### 移动端
- 优化的移动端布局
- 触摸友好的按钮设计
- 简化的信息展示

## 技术实现

### 数据获取
- 从Google Sheets API获取记录详情
- 从Receipt工作表获取关联收据
- 实时数据更新

### 状态管理
- 使用React hooks管理组件状态
- 错误处理和加载状态
- 用户权限验证

### 文件处理
- 支持base64编码的文件显示
- 图片预览功能
- 文件下载功能

## 使用流程

1. **访问详情页面**
   - 从财务记录列表点击"Details"按钮
   - 或直接访问 `/financial-list/[record-key]`

2. **查看记录信息**
   - 查看记录的基本信息和状态
   - 查看创建和审批信息

3. **管理收据**
   - 查看关联的收据列表
   - 预览或下载收据文件
   - 删除不需要的收据

4. **执行操作**
   - 编辑记录（需要权限）
   - 更改记录状态（需要权限）
   - 删除记录（需要权限）

## 安全特性

- **权限验证**: 所有操作都需要相应的用户权限
- **确认对话框**: 危险操作需要用户确认
- **错误处理**: 完善的错误处理和用户提示
- **数据验证**: 输入数据的验证和清理

## 集成功能

- **收据上传**: 与GoogleSheetsReceiptUpload组件集成
- **状态管理**: 与记录状态更新API集成
- **导航**: 与财务记录列表页面集成
- **权限**: 与用户权限系统集成

## 未来改进

- 添加收据批量操作功能
- 支持收据搜索和筛选
- 添加收据预览的缩略图
- 支持更多文件格式
- 添加收据历史记录 